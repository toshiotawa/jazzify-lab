# ジャズ学習アプリケーション新機能仕様書

## 📋 現在のアプリケーション概要
- **技術スタック**: React + TypeScript + Vite + Zustand + PIXI.js + Tone.js
- **機能**: ジャズ楽曲を使った音楽ゲーム（ピアノ・ギター対応）
- **音声入力**: MIDI・オーディオ入力（WASM PYINピッチ検出）
- **現在の状態**: 基本的なゲーム機能は実装済み

## 🎯 新機能要件

### 1. 認証・アカウント機能
- **Supabase Magic Link認証**
  - 初期画面追加
  - おためしボタン（ログインなし）
  - 会員登録・ログイン（メールアドレス入力）
  - ログイン後の新規アカウント登録フロー（利用規約・プライバシーポリシー同意、ニックネーム設定）

### 2. ユーザー管理システム
- **会員ランク制度**
  - フリー・スタンダード・プレミアム・プラチナ
  - 管理画面でのステータス変更機能
- **ヘッダー機能**
  - 左端：トップページボタン
  - 右端：アカウントボタン（モーダル表示）
  - アカウントボタン左：マイページボタン

### 3. 楽曲管理システム
- **管理画面**: shadcn/ui + React-Hook-Form
- **曲登録ダッシュボード**（JSONハードコーディングから移行）
- **無料会員向け楽曲制限機能**

### 4. 経験値・レベルシステム
- **獲得経験値**
  - 本番モード終了時に獲得
  - 会員ランク倍率（1x/1.5x/2x）
  - 再生速度による調整
  - スコアランクによる変動（S:1000点、最低:100点）
  - 移調プレイ時1.3倍ボーナス
- **レベルテーブル**
  - Lv1-10：2000点/レベル
  - Lv11-50：5000点/レベル
  - Lv51以上：20000点/レベル
- **ランキング機能**
  - 全期間レベルランキング
  - 表示項目：ニックネーム、レベル、会員ランク、クリアレッスン数

### 5. マイページ機能
- **楽曲記録表示**
  - 楽曲一覧
  - 最高ランク、Bランク以上のクリア回数
- **結果画面拡張**
  - 獲得経験値・ボーナス表示
  - レベル表示（レベルアップ時のアニメーション）

### 6. レッスン機能
- **プレミアム・プラチナ限定**（一部楽曲は無料開放）
- **階層構造**: レッスン → コース → 動画＋楽曲
- **動画**: Vimeo埋め込み
- **楽曲クリア条件**: キー、再生速度、スコアランク、クリア回数、楽譜表示設定
- **プラチナ特典**: 
  - LINE講師とのやり取り機能
  - 提出課題システム
  - レッスンスキップ機能
- **経験値ボーナス**: レッスン楽曲の本番モードで2倍

### 7. チャレンジ・ミッション機能
- **ウィークリーチャレンジ・マンスリーミッション**
- **管理画面で追加・編集**
- **マイページ表示**: 進捗バー付き
- **達成報酬**: 翌シーズン経験値1.3倍
- **ランキング表示**: 当シーズンと前シーズン（先着100名）

### 8. コミュニティ機能
- **練習記録（日記）機能**
  - 1日1記事作成
  - 編集不可、コメント・いいね機能
  - ユーザー名クリックで個人練習日記ページへ遷移
- **コミュニティタブ**: 全ユーザーの練習日記表示

## 🏗️ 実装計画

### Phase 1: 基盤整備（2週間）
1. **Supabase統合**
   - 認証機能実装
   - データベース設計
   - 初期画面作成
2. **shadcn/ui統合**
   - コンポーネントライブラリ導入
   - 基本的なUI構築

### Phase 2: ユーザー管理（3週間）
1. **アカウント機能**
   - 会員登録・ログインフロー
   - 会員ランク管理
   - ヘッダー・アカウントモーダル
2. **管理画面**
   - 楽曲管理ダッシュボード
   - ユーザー管理機能

### Phase 3: ゲーム機能拡張（3週間）
1. **経験値システム**
   - レベル計算ロジック
   - 結果画面拡張
   - ランキング機能
2. **マイページ**
   - 楽曲記録表示
   - 統計情報

### Phase 4: レッスン機能（4週間）
1. **レッスン管理**
   - 階層構造実装
   - 動画埋め込み
   - クリア条件システム
2. **プラチナ特典**
   - 課題システム
   - スキップ機能

### Phase 5: コミュニティ機能（3週間）
1. **チャレンジ・ミッション**
   - 管理画面
   - 進捗管理
   - ランキング
2. **練習記録**
   - 日記機能
   - コミュニティタブ

### Phase 6: 統合・テスト（2週間）
1. **全機能統合**
2. **パフォーマンス最適化**
3. **総合テスト**

## 🔧 技術要件追加
- **Supabase**: 認証・データベース
- **shadcn/ui**: UIコンポーネント
- **React Hook Form**: フォーム管理
- **Vimeo**: 動画埋め込み
- **LINE API**: 講師とのやり取り機能

## 📊 プロジェクト概要
- **開発期間**: 約12-16週間
- **開発体制**: フルスタック開発者
- **リリース方式**: 段階的リリース（MVP → 機能追加）

## 🎯 成功指標
- **ユーザーエンゲージメント**: DAU/MAU比率向上
- **収益化**: プレミアム・プラチナ会員獲得
- **学習効果**: レッスン完了率、スキル向上指標
- **コミュニティ活性化**: 練習記録投稿数、いいね・コメント数

---

**作成日**: 2025-01-08  
**バージョン**: 1.0  
**次のステップ**: データベース設計・API設計の詳細化