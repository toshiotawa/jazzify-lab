# ファンタジーモード：プログレッション拡張版

## 概要

ファンタジーモードのプログレッションパターンに、より詳細なタイミング制御を追加する拡張機能です。

## 主な特徴

1. **JSONベースのタイミング制御**
   - `chord_progression_data`フィールドで詳細なタイミングを指定可能
   - 小節とビート単位で出題タイミングを制御

2. **自動進行**
   - 判定窓内に正解できなかった場合、自動的に次の問題へ進む
   - 失敗時は敵が攻撃してくる演出

3. **NULL期間**
   - コード間に空白期間を設けることが可能
   - 判定受付終了から次の出題までの間は表示がNULLになる

## JSONフォーマット

```json
[
  { "bar": 1, "beat": 4.5, "chord": "C"  },
  { "bar": 2, "beat": 1.0, "chord": "F"  },
  { "bar": 2, "beat": 3.5, "chord": "G"  },
  { "bar": 2, "beat": 4.5, "chord": "Am" }
]
```

- `bar`: 1始まりの小節番号
- `beat`: 0.5単位の拍数（4.5 = 4拍目ウラ）
- `chord`: 出題するコード名

## タイミング仕様

- **出題タイミング**: 指定されたbeat値
- **判定受付開始**: 出題タイミングの0.5拍前
- **判定受付終了**: 次のコードの判定受付開始時刻

## 実装詳細

### 追加された型定義

- `RawProgressionEvent`: JSONから読み込むイベントデータ
- `CompiledProgressionEvent`: 実行時に使用する変換済みデータ

### 追加された関数

- `compileProgression()`: JSONデータを実行可能な形式に変換
- `getAbsoluteBeat()`: カウントイン後の絶対拍数を取得

### UIの変更

- enemy_gaugeは表示されない（プログレッション拡張モード時）
- 現在のコードがNULLの場合は何も表示されない